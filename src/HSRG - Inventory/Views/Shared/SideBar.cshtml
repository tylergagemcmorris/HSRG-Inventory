@model HSRG___Inventory.Models.TableTimestamps

@{ 
    
}

<div id="sidebar-wrapper" style="background : #fff">
    
    <ul class="sidebar-nav">
        <li class="sidebar-brand" style="">
            Table List
        </li>
        
        @foreach (System.Reflection.PropertyInfo property in ViewBag.properties)
        {
            if (property.Name != "ID")
            {
                <li>
                    <a href="#" onclick="return RefreshTable('@property.Name')">
                        
                        <p>@property.Name</p>
                        <p id="time">@property.GetValue(Model, null)</p>
                    </a>
                </li>
            }

        }
    </ul>
</div>
<script>

    function RefreshTable(table) {
        FlushTableFunction(table);
        ReloadTableFunction(table);
    }

        function FlushTableFunction(table) {
            $.ajax({
                url: '@Url.Action("FlushInventory","Home")' + '?table=' + table,
                type: 'GET',
                contentType: false,
                dataType: 'text',
                success: function (data) { alert("Table Flushed"); console.log(data) },
                error: function (error) { alert(error) }
            });
        };

        function ReloadTableFunction(table) {
            $.ajax({
                url: '@Url.Action("UpdateTables", "UpdateDB")' + '?table=' + table,
                type: 'GET',
                contentType: false,
                dataType: 'text',
                success: function (data) {
                    alert("Table Reloaded");
                    var test = data;
                    console.log(data)
                    $.post("@Url.Action("UpdateTime", "UpdateDB")", { result: test });
                    location.reload();
                    Toggler(); //Doesn't work, attempting an ajax solution
                },
                error: function (error) { alert(error) }
            });
        };



</script>

<script>
        function Toggler()
        {
            $("#wrapper").toggleClass("toggled");
        }
</script>

<script>
        function ajaxupdatetime() //If I get it to work will update the text without having to reload the page
        {
            @foreach (System.Reflection.PropertyInfo property in ViewBag.properties)
            {
                if (property.Name != "ID")
                {
                    //$("#time").text(@property.GetValue(Model, null));
                }

            }
        }
</script>